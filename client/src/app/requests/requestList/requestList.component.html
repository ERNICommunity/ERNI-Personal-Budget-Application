<p-confirmDialog
  [style]="{ width: '50vw' }"
  [baseZIndex]="10000"
  rejectButtonStyleClass="p-button-text"
></p-confirmDialog>

<p-tabMenu [model]="years" [activeItem]="selectedYearItem"></p-tabMenu>

<p-tabMenu
  [model]="budgetTypeMenuItems"
  [activeItem]="selectedBudgetTypeItem"
></p-tabMenu>

<p-tabMenu
  [model]="approvalStateMenuItems"
  [activeItem]="selectedApprovalState"
></p-tabMenu>

<p-toolbar>
  <div class="p-toolbar-group-left">
    <span class="p-input-icon-left">
      <i class="pi pi-search"></i>
      <input
        type="text"
        pInputText
        placeholder="Search employee"
        [(ngModel)]="searchTerm"
      />
    </span>
  </div>

  <div class="p-toolbar-group-right">
    <button
      type="button"
      pButton
      icon="pi pi-bars"
      label="Export"
      (click)="menu.toggle($event)"
    ></button>

    <p-menu #menu [popup]="true" [model]="exportMenuItems"></p-menu>
  </div>
</p-toolbar>
<p-table
  [value]="filteredRequests"
  styleClass="p-datatable-gridlines p-datatable-striped"
  responsiveLayout="scroll"
>
  <ng-template pTemplate="header">
    <tr>
      <th scope="col">Employee</th>
      <th scope="col">Title</th>
      <th scope="col">Amount</th>
      <th scope="col">Budget</th>
      <th scope="col">Create date</th>
      <th scope="col">Details</th>
      <th scope="col"></th>
      <th scope="col"></th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-request>
    <tr>
      <td>{{ request.user.firstName }} {{ request.user.lastName }}</td>
      <td>{{ request.title }}</td>
      <td>{{ request.amount }}</td>
      <td>{{ request.budget.title }}</td>
      <td>{{ request.createDate | date: 'dd/MM/yyyy' }}</td>

      <td>
        <a pButton class="p-button-sm" routerLink="detail/{{ request.id }}">
          Detail
        </a>
      </td>
      <td>
        <div *ngIf="isAdmin">
          <div *ngIf="request.state === requestFilterType.Pending">
            <button
              pButton
              type="button"
              (click)="completeRequest(request)"
              class="p-button-sm"
            >
              Approve
            </button>
          </div>
        </div>
      </td>
      <td
        *ngIf="requestFilter !== requestFilterType.Rejected"
        class="button-table-cell"
      >
        <div *ngIf="canRejectRequest(request.id); else cannotReject">
          <button
            pButton
            type="button"
            class="p-button-sm"
            (click)="openRejectConfirmationModal(request)"
          >
            Reject
          </button>
          <button
            pButton
            type="button"
            class="p-button-sm"
            (click)="openDeleteConfirmationModal(request)"
          >
            Delete
          </button>
        </div>
      </td>
    </tr>
  </ng-template>
</p-table>

<router-outlet></router-outlet>
