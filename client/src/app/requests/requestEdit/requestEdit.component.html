<p-dialog
  [header]="isNewRequest() ? 'Create New Request' : 'Request Details'"
  [(visible)]="showDialog"
  [breakpoints]="{ '1199px': '75vw', '575px': '90vw' }"
  [style]="{ width: '50vw' }"
  [draggable]="false"
  [modal]="true"
  [resizable]="false"
  (onHide)="onHide()"
>
  <app-alert id="addRequestError"></app-alert>

  <div class="grid">
    @if (request(); as request) {
      <div class="col">
        <app-basic-request-info-editor
          [request]="request"
          [isReadonly]="request.state !== RequestState.Pending || isSaveInProgress()"
        ></app-basic-request-info-editor>
      </div>
    }
    <div class="col">
      <app-file-list
        [uploadEnabled]="this.request()?.state === RequestState.Pending && !isSaveInProgress()"
        [files]="files()"
        (newImageAdded)="onNewImageAdded($event)"
      ></app-file-list>
    </div>
  </div>

  <div class="flex justify-content-end">
    <p-button
      *ngIf="request()?.state === RequestState.Pending"
      class="block mt-2"
      styleClass="p-button-success"
      [icon]="isNewRequest() ? '' : 'pi pi-save'"
      [loading]="isSaveInProgress()"
      [label]="isNewRequest() ? 'Create Request' : 'Update Request'"
      (click)="save()"
    ></p-button>

    <div *ngIf="request()?.state === RequestState.Approved">
      <p class="text-green-600 font-bold mb-0"><i class="pi pi-check mr-2"></i>Request Approved</p>
    </div>
  </div>
</p-dialog>
