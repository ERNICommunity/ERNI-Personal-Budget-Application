<div class="block mb-2">Attachments</div>

@if (uploadEnabled()) {
  <input #fileUpload type="file" multiple [accept]="acceptedFileTypes" hidden (change)="onFileSelect($event)" />
  <div
    pDroppable
    class="border-dashed border-round-2xl border-400 p-5 mb-2 flex flex-column align-items-center gap-2"
    (onDrop)="onFileSelect($event)">
    <i class="pi pi-cloud-upload text-7xl text-400"></i>
    <p class="text-center m-0">
      <span>Drag & drop to upload or</span>
      <a class="p-link text-primary p-1 hover:bg-gray-100" role="button" tabindex="0" (click)="fileUpload.click()"
        >browse</a
      >
    </p>
  </div>
  @if (errorMessage(); as errorMessage) {
    <small class="p-error block mt-2">{{ errorMessage }}</small>
  }
}

@if (files().length > 0) {
  <ul class="list-none p-0 m-0">
    @for (file of files(); track file.name) {
      <li class="flex justify-content-between align-items-center gap-2 py-1">
        <i class="pi pi-file text-color-secondary"></i>
        <div class="flex-grow-1 text-color-secondary">{{ file.name }}</div>
        @if (file.status.code === 'new') {
          <button class="p-2 p-button p-button-rounded p-button-link p-button-text p-button-danger">
            <i class="pi pi-times" (click)="removeFile(file)"></i>
          </button>
        }
        @if (file.status.code === 'in-progress') {
          <p-progressBar class="w-5rem" [value]="40" [showValue]="false" />
        }
        @if (file.status.code === 'saved') {
          <button class="p-2 p-button p-button-rounded p-button-link p-button-text p-button-secondary">
            <i class="pi pi-download" (click)="download(file.status.id)"></i>
          </button>
        }
      </li>
    }
  </ul>
}
